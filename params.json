{"name":"VirusTotal Public API 2.0 Implementation in Java","tagline":"VirusTotal public API 2.0 Implementation in Java","body":"Virustotal-Public-API-V2.0-Client\r\n=================================\r\n\r\nVirusTotal is a free service that analyzes suspicious files and URLs and facilitates the quick detection of viruses, worms, trojans, and all kinds of malware.\r\n\r\nThis is project is a VirusTotal public API version 2.0 implementation in Java.\r\n\r\nRequirements\r\n------------\r\n- [JDK 1.5 or higher version]\r\n- [Apache Maven 3.x]\r\n\r\nGetting started\r\n---------------\r\n1. Clone project from GIT repo\r\n - `git clone https://github.com/kdkanishka/Virustotal-Public-API-V2.0-Client.git`\r\n2. OR Download the project as a zip file and extract\r\n - `https://github.com/kdkanishka/Virustotal-Public-API-V2.0-Client/archive/master.zip`\r\n3. Build and install the project using maven\r\n - `mvn clean install -DskipTests`\r\n4. Add following dependency to your maven project\r\n\r\n``` xml\r\n<dependency>\r\n      <groupId>com.kanishka.api</groupId>\r\n      <artifactId>VirustotalPublicV2.0</artifactId>\r\n      <version>1.0-SNAPSHOT</version>\r\n</dependency>\r\n```\r\n* If your project is not maven based, add `target/VirustotalPublicV2.0-1.0-SNAPSHOT.jar` file to your class path.\r\n\r\nHow to use API\r\n---------------------\r\n### Sample codes\r\n##### scan a given file\r\n\r\n```Java\r\n    public void scanFile() {\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            ScanInfo scanInformation = virusTotalRef.scanFile(new File(\"/Users/kdesilva/Desktop/eicar.com.txt\"));\r\n            \r\n            System.out.println(\"___SCAN INFORMATION___\");\r\n            System.out.println(\"MD5 :\\t\" + scanInformation.getMd5());\r\n            System.out.println(\"Perma Link :\\t\" + scanInformation.getPermalink());\r\n            System.out.println(\"Resource :\\t\" + scanInformation.getResource());\r\n            System.out.println(\"Scan Date :\\t\" + scanInformation.getScan_date());\r\n            System.out.println(\"Scan Id :\\t\" + scanInformation.getScan_id());\r\n            System.out.println(\"SHA1 :\\t\" + scanInformation.getSha1());\r\n            System.out.println(\"SHA256 :\\t\" + scanInformation.getSha256());\r\n            System.out.println(\"Verbose Msg :\\t\" + scanInformation.getVerbose_msg());\r\n            System.out.println(\"Response Code :\\t\" + scanInformation.getResponse_code());\r\n            System.out.println(\"done.\");\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n\r\n##### Get File Scan Report\r\n``` Java\r\n    public void getFileScanReport() {\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            String resource=\"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f\";\r\n            FileScanReport report = virusTotalRef.getScanReport(resource);\r\n\r\n            System.out.println(\"MD5 :\\t\" + report.getMd5());\r\n            System.out.println(\"Perma link :\\t\" + report.getPermalink());\r\n            System.out.println(\"Resourve :\\t\" + report.getResource());\r\n            System.out.println(\"Scan Date :\\t\" + report.getScan_date());\r\n            System.out.println(\"Scan Id :\\t\" + report.getScan_id());\r\n            System.out.println(\"SHA1 :\\t\" + report.getSha1());\r\n            System.out.println(\"SHA256 :\\t\" + report.getSha256());\r\n            System.out.println(\"Verbose Msg :\\t\" + report.getVerbose_msg());\r\n            System.out.println(\"Response Code :\\t\" + report.getResponse_code());\r\n            System.out.println(\"Positives :\\t\" + report.getPositives());\r\n            System.out.println(\"Total :\\t\" + report.getTotal());\r\n\r\n            HashMap<String, VirusScanInfo> scans = report.getScans();\r\n            for (String key : scans.keySet()) {\r\n                VirusScanInfo virusInfo = scans.get(key);\r\n                System.out.println(\"Scanner : \" + key);\r\n                System.out.println(\"\\t\\t Resut : \" + virusInfo.getResult());\r\n                System.out.println(\"\\t\\t Update : \" + virusInfo.getUpdate());\r\n                System.out.println(\"\\t\\t Version :\" + virusInfo.getVersion());\r\n            }\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n##### Scan URL\r\n``` Java\r\n    public void scanUrl() {\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            String urls[] = {\"www.google.lk\", \"www.yahoo.com\"};\r\n            ScanInfo[] scanInfoArr = virusTotalRef.scanUrls(urls);\r\n\r\n            for (ScanInfo scanInformation : scanInfoArr) {\r\n                System.out.println(\"___SCAN INFORMATION___\");\r\n                System.out.println(\"MD5 :\\t\" + scanInformation.getMd5());\r\n                System.out.println(\"Perma Link :\\t\" + scanInformation.getPermalink());\r\n                System.out.println(\"Resource :\\t\" + scanInformation.getResource());\r\n                System.out.println(\"Scan Date :\\t\" + scanInformation.getScan_date());\r\n                System.out.println(\"Scan Id :\\t\" + scanInformation.getScan_id());\r\n                System.out.println(\"SHA1 :\\t\" + scanInformation.getSha1());\r\n                System.out.println(\"SHA256 :\\t\" + scanInformation.getSha256());\r\n                System.out.println(\"Verbose Msg :\\t\" + scanInformation.getVerbose_msg());\r\n                System.out.println(\"Response Code :\\t\" + scanInformation.getResponse_code());\r\n                System.out.println(\"done.\");\r\n            }\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n##### Get URL Report\r\n``` Java\r\n    public void getUrlReport(){\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            String urls[] = {\"mahamegha.com\",\"mahamegha.info\"};\r\n            FileScanReport[] reports = virusTotalRef.getUrlScanReport(urls, false);\r\n\r\n            for (FileScanReport report : reports) {\r\n                if(report.getResponse_code()==0){\r\n                    continue;\r\n                }\r\n                System.out.println(\"MD5 :\\t\" + report.getMd5());\r\n                System.out.println(\"Perma link :\\t\" + report.getPermalink());\r\n                System.out.println(\"Resourve :\\t\" + report.getResource());\r\n                System.out.println(\"Scan Date :\\t\" + report.getScan_date());\r\n                System.out.println(\"Scan Id :\\t\" + report.getScan_id());\r\n                System.out.println(\"SHA1 :\\t\" + report.getSha1());\r\n                System.out.println(\"SHA256 :\\t\" + report.getSha256());\r\n                System.out.println(\"Verbose Msg :\\t\" + report.getVerbose_msg());\r\n                System.out.println(\"Response Code :\\t\" + report.getResponse_code());\r\n                System.out.println(\"Positives :\\t\" + report.getPositives());\r\n                System.out.println(\"Total :\\t\" + report.getTotal());\r\n\r\n                HashMap<String, VirusScanInfo> scans = report.getScans();\r\n                for (String key : scans.keySet()) {\r\n                    VirusScanInfo virusInfo = scans.get(key);\r\n                    System.out.println(\"Scanner : \" + key);\r\n                    System.out.println(\"\\t\\t Resut : \" + virusInfo.getResult());\r\n                    System.out.println(\"\\t\\t Update : \" + virusInfo.getUpdate());\r\n                    System.out.println(\"\\t\\t Version :\" + virusInfo.getVersion());\r\n                }\r\n            }\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n##### Get IP Address Report\r\n``` Java\r\n    public void getIPReport {\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            IPAddressReport report = virusTotalRef.getIPAddresReport(\"69.195.124.58\");\r\n\r\n            System.out.println(\"___IP Rport__\");\r\n\r\n            Sample[] communicatingSamples = report.getDetected_communicating_samples();\r\n            if (communicatingSamples != null) {\r\n                System.out.println(\"Communicating Samples\");\r\n                for (Sample sample : communicatingSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            Sample[] detectedDownloadedSamples = report.getDetected_downloaded_samples();\r\n            if (detectedDownloadedSamples != null) {\r\n                System.out.println(\"Detected Downloaded Samples\");\r\n                for (Sample sample : detectedDownloadedSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            URL[] urls = report.getDetected_urls();\r\n            if (urls != null) {\r\n                System.out.println(\"Detected URLs\");\r\n                for (URL url : urls) {\r\n                    System.out.println(\"URL : \" + url.getUrl());\r\n                    System.out.println(\"Positives : \" + url.getPositives());\r\n                    System.out.println(\"Total : \" + url.getTotal());\r\n                    System.out.println(\"Scan Date\" + url.getScan_date());\r\n                }\r\n            }\r\n\r\n            Resolution[] resolutions = report.getResolutions();\r\n            if (resolutions != null) {\r\n                System.out.println(\"Resolutions\");\r\n                for (Resolution resolution : resolutions) {\r\n                    System.out.println(\"IP Address : \" + resolution.getIp_address());\r\n                    System.out.println(\"Last Resolved : \" + resolution.getLast_resolved());\r\n                }\r\n            }\r\n\r\n            Sample[] unDetectedDownloadedSamples = report.getUndetected_downloaded_samples();\r\n            if (unDetectedDownloadedSamples != null) {\r\n                System.out.println(\"Undetected Downloaded Samples\");\r\n                for (Sample sample : unDetectedDownloadedSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            Sample[] unDetectedCommunicatingSamples = report.getUndetected_communicating_samples();\r\n            if (unDetectedCommunicatingSamples != null) {\r\n                System.out.println(\"Undetected Communicating Samples\");\r\n                for (Sample sample : unDetectedCommunicatingSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            System.out.println(\"Response Code : \" + report.getResponse_code());\r\n            System.out.println(\"Verbose Message : \" + report.getVerbose_msg());\r\n\r\n\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n##### Get Domain Report\r\n``` Java\r\n    public void getDomainReport() {\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            DomainReport report = virusTotalRef.getDomainReport(\"www.ntt62.com\");\r\n            System.out.println(\"___Domain Rport__\");\r\n\r\n            Sample[] communicatingSamples = report.getDetected_communicating_samples();\r\n            if (communicatingSamples != null) {\r\n                System.out.println(\"Communicating Samples\");\r\n                for (Sample sample : communicatingSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            Sample[] detectedDownloadedSamples = report.getDetected_downloaded_samples();\r\n            if (detectedDownloadedSamples != null) {\r\n                System.out.println(\"Detected Downloaded Samples\");\r\n                for (Sample sample : detectedDownloadedSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            URL[] urls = report.getDetected_urls();\r\n            if (urls != null) {\r\n                System.out.println(\"Detected URLs\");\r\n                for (URL url : urls) {\r\n                    System.out.println(\"URL : \" + url.getUrl());\r\n                    System.out.println(\"Positives : \" + url.getPositives());\r\n                    System.out.println(\"Total : \" + url.getTotal());\r\n                    System.out.println(\"Scan Date\" + url.getScan_date());\r\n                }\r\n            }\r\n\r\n            Resolution[] resolutions = report.getResolutions();\r\n            if (resolutions != null) {\r\n                System.out.println(\"Resolutions\");\r\n                for (Resolution resolution : resolutions) {\r\n                    System.out.println(\"IP Address : \" + resolution.getIp_address());\r\n                    System.out.println(\"Last Resolved : \" + resolution.getLast_resolved());\r\n                }\r\n            }\r\n\r\n            Sample[] unDetectedDownloadedSamples = report.getUndetected_downloaded_samples();\r\n            if (unDetectedDownloadedSamples != null) {\r\n                System.out.println(\"Undetected Downloaded Samples\");\r\n                for (Sample sample : unDetectedDownloadedSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            Sample[] unDetectedCommunicatingSamples = report.getUndetected_communicating_samples();\r\n            if (unDetectedCommunicatingSamples != null) {\r\n                System.out.println(\"Undetected Communicating Samples\");\r\n                for (Sample sample : unDetectedCommunicatingSamples) {\r\n                    System.out.println(\"SHA256 : \" + sample.getSha256());\r\n                    System.out.println(\"Date : \" + sample.getDate());\r\n                    System.out.println(\"Positives : \" + sample.getPositives());\r\n                    System.out.println(\"Total : \" + sample.getTotal());\r\n                }\r\n            }\r\n\r\n            System.out.println(\"Response Code : \" + report.getResponse_code());\r\n            System.out.println(\"Verbose Message : \" + report.getVerbose_msg());\r\n\r\n\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n#### Posting Comments\r\n``` Java\r\n    public void addComment(){\r\n        try {\r\n            VirusTotalConfig.getConfigInstance().setVirusTotalAPIKey(\"APIKEY\");\r\n            VirustotalPublicV2 virusTotalRef = new VirustotalPublicV2Impl();\r\n\r\n            String resource = \"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f\";\r\n            String comment = \"Eicar file! considered a goodware\";\r\n            GeneralResponse gRespo = virusTotalRef.makeAComment(resource, comment);\r\n\r\n            System.out.println(\"Response Code : \" + gRespo.getResponse_code());\r\n            System.out.println(\"Verbose Message : \" + gRespo.getVerbose_msg());\r\n\r\n        } catch (APIKeyNotFoundException ex) {\r\n            System.err.println(\"API Key not found! \" + ex.getMessage());\r\n        } catch (UnsupportedEncodingException ex) {\r\n            System.err.println(\"Unsupported Encoding Format!\" + ex.getMessage());\r\n        } catch (UnauthorizedAccessException ex) {\r\n            System.err.println(\"Invalid API Key \" + ex.getMessage());\r\n        } catch (Exception ex) {\r\n            System.err.println(\"Something Bad Happened! \" + ex.getMessage());\r\n        }\r\n    }\r\n```\r\n### Support or Contact\r\nHaving trouble with this api ? contact kdkanishka@gmail.com and I'll help you to sort it out.\r\n\r\n### Contribute to this Project\r\nYou are welcome to suggest new features and improvements. please feel free to fork and make pull requests with your additions and improvements. \r\n\r\n[JDK 1.5 or higher version]:http://www.oracle.com/technetwork/java/javase/downloads/index.html\r\n[Apache Maven 3.x]:http://maven.apache.org\r\n\r\n","google":"UA-9456844-7","note":"Don't delete this file! It's used internally to help with page regeneration."}